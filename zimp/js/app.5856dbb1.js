!function(){"use strict";var e,t={1518:function(e,t,s){s.r(t)},1587:function(e,t,s){var a=s(5471),i={components:{},created(){}},o=s(1656),n=(0,o.A)(i,(function(){var e=this._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)}),[],!1,null,null,null).exports,r=s(173);s(4114);var c=new a.Ay,m=3,l=3,d={indoors:[{key:"foyer",name:"玄关",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/foyer.jpg",doors:[0],outDoor:[],desc:"固定起始地点",addHp:0},{key:"bathroom",name:"浴室",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/bathroom.jpg",doors:[0],outDoor:[],desc:"",addHp:0},{key:"kitchen",name:"厨房",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/kitchen.jpg",doors:[0,1,3],outDoor:[],desc:"回合结束停留在此房间可恢复1点生命",addHp:1},{key:"storage",name:"储藏室",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/storage.jpg",doors:[0],outDoor:[],desc:"可选择搜寻1个新物品",addHp:0},{key:"evilTemple",name:"邪恶祭坛",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/evilTemple.jpg",doors:[1,3],outDoor:[],desc:"可选择搜寻邪恶图腾！",addHp:0},{key:"familyRoom",name:"客厅",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/familyRoom.jpg",doors:[0,1,3],outDoor:[],desc:"",addHp:0},{key:"diningRoom",name:"餐厅",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/diningRoom.jpg",doors:[0,1,2,3],outDoor:[0],desc:"可通过出口到达户外，寻找墓地填埋邪恶图腾！",addHp:0},{key:"bedroom",name:"卧室",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/bedroom.jpg",doors:[0,3],outDoor:[],desc:"",addHp:0}],outdoors:[{key:"patio",name:"露台",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/patio.jpg",doors:[0,1,2],desc:"户外起始地点，快寻找墓地填埋邪恶图腾！",addHp:0},{key:"garden",name:"花园",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/garden.jpg",doors:[1,2,3],desc:"回合结束停留在此处可恢复1点生命",addHp:1},{key:"sittingArea",name:"休息区",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/sittingArea.jpg",doors:[1,2,3],desc:"",addHp:0},{key:"yard1",name:"庭院",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/yard1.jpg",doors:[1,2,3],desc:"这里有生机勃勃的绿植",addHp:0},{key:"yard2",name:"庭院",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/yard2.jpg",doors:[1,2,3],desc:"这里有供小孩玩耍的秋千和跷跷板",addHp:0},{key:"yard3",name:"庭院",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/yard3.jpg",doors:[1,2,3],desc:"这里有两把可供休息的椅子",addHp:0},{key:"graveyard",name:"墓地",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/graveyard.jpg",doors:[1,2],desc:"将邪恶图腾填埋到这里！",addHp:0},{key:"garage",name:"车库",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/garage.jpg",doors:[2,3],desc:"",addHp:0}]},h={baseAtk:1,baseHp:6,maxHp:Number.POSITIVE_INFINITY,maxDamage:4,runAwayDamage:1,maxItems:2,backpackerExtraItems:1,sportgirlReduceDiscardEvents:1},p={items:[{key:"oil",name:"煤油",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/oil.jpg",type:"item",addAtk:0,addHp:0,desc:"逃跑时使用可以免受伤害，和蜡烛一起使用可以杀死所有房间的丧尸",useTime:1},{key:"gasoline",name:"汽油",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/gasoline.jpg",type:"item",addAtk:0,addHp:0,desc:"和蜡烛一起使用可以杀死所有房间的丧尸，和链锯一起使用为链锯增加2次额外使用次数",useTime:1},{key:"board",name:"木板",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/board.jpg",type:"weapon",addAtk:1,addHp:0,desc:"增加1点攻击",useTime:99},{key:"bone",name:"骨棒",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/bone.jpg",type:"weapon",addAtk:2,addHp:0,desc:"增加2点攻击，但它恐怖的样子会让你在畏缩时少回复1点生命",useTime:99},{key:"golf",name:"高尔夫球棍",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/golf.jpg",type:"weapon",addAtk:1,addHp:0,desc:"增加1点攻击",useTime:99},{key:"chainsaw",name:"链锯",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/chainsaw.jpg",type:"weapon",addAtk:3,addHp:0,desc:"增加3点攻击，但需要燃料来维持使用",useTime:2},{key:"machete",name:"砍刀",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/machete.jpg",type:"weapon",addAtk:2,addHp:0,desc:"增加2点攻击",useTime:99},{key:"soda",name:"苏打水",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/soda.jpg",type:"item",addAtk:0,addHp:2,desc:"增加2点生命",useTime:1},{key:"candle",name:"蜡烛",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/candle.jpg",type:"item",addAtk:0,addHp:0,desc:"和煤油/汽油一起使用可以杀死所有房间的丧尸",useTime:1},{key:"grenade",name:"手雷",image:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/grenade.jpg",type:"item",addAtk:0,addHp:0,desc:"可以杀死所有房间的丧尸",useTime:1}]},g={discardCount:2,events:[{timeEvents:[{key:"msg",zombies:0,addHp:0,desc:"你尽力保持身上干燥"},{key:"getItem",zombies:0,addHp:0,desc:"可获得新物品"},{key:"battle",zombies:6,addHp:0,desc:"战斗"}],item:"oil"},{timeEvents:[{key:"battle",zombies:4,addHp:0,desc:"战斗"},{key:"effect",zombies:0,addHp:-1,desc:"你感觉希望正在陨灭..."},{key:"getItem",zombies:0,addHp:0,desc:"可获得新物品"}],item:"gasoline"},{timeEvents:[{key:"getItem",zombies:0,addHp:0,desc:"可获得新物品"},{key:"battle",zombies:4,addHp:0,desc:"战斗"},{key:"effect",zombies:0,addHp:-1,desc:"你的嘴里感觉到刺痛"}],item:"board"},{timeEvents:[{key:"battle",zombies:4,addHp:0,desc:"战斗"},{key:"effect",zombies:0,addHp:-1,desc:"一只蝙蝠飞扑向你，伤到你的眼睛"},{key:"battle",zombies:6,addHp:0,desc:"战斗"}],item:"machete"},{timeEvents:[{key:"getItem",zombies:0,addHp:0,desc:"可获得新物品"},{key:"battle",zombies:5,addHp:0,desc:"战斗"},{key:"effect",zombies:0,addHp:-1,desc:"你感觉灵魂就要脱离身体"}],item:"bone"},{timeEvents:[{key:"effect",zombies:0,addHp:-1,desc:"你踩到一滩不知道是什么的脏东西，摔了一跤"},{key:"battle",zombies:4,addHp:0,desc:"战斗"},{key:"msg",zombies:0,addHp:0,desc:"空气中能闻到血腥味"}],item:"golf"},{timeEvents:[{key:"battle",zombies:3,addHp:0,desc:"战斗"},{key:"msg",zombies:0,addHp:0,desc:"你能听到恐怖的尖叫声"},{key:"battle",zombies:5,addHp:0,desc:"战斗"}],item:"chainsaw"},{timeEvents:[{key:"effect",zombies:0,addHp:1,desc:"你发现口袋里有一块糖，吃下补充了些能量"},{key:"getItem",zombies:0,addHp:0,desc:"可获得新物品"},{key:"battle",zombies:4,addHp:0,desc:"战斗"}],item:"soda"},{timeEvents:[{key:"msg",zombies:0,addHp:0,desc:"你的身体正在不由自主的颤抖"},{key:"effect",zombies:0,addHp:1,desc:"你感觉到一丝希望"},{key:"battle",zombies:4,addHp:0,desc:"战斗"}],item:"candle"}]},y={sysName:"zimp-h5",time:0,events:[],indoors:[],outdoors:[],map:[]},u={character:"",hp:0,atk:0,x:0,y:0,gotTotem:!1,buriedTotem:!1,maxItems:0,items:[]},w=s(1619);const v=e=>{const t=JSON.parse(JSON.stringify(e)),s=w.Y7.multiRandom(t.length,t.length-1,0),a=[];return s.forEach((e=>{a.push(t[e])})),a};const f={1:"backpacker",2:"sportgirl",3:"oldman",4:"soldier"},x={1:"旅行者：身上可以多携带一件物品，初始携带一根蜡烛",2:"健身女孩：行动敏捷，在最终时间前能完成更多事件。初始携带一罐苏打水",3:"中年男人：初始携带一桶汽油",4:"特种兵：初始携带一枚手雷，可炸死一个房间的所有丧尸"};var b={data(){return{isShow:!0,desc:"丧尸到处游荡，你必须在午夜12点的钟声前，找到有邪恶祭坛的房子，拿到邪恶图腾并带到外面的墓地将其埋入土中才能令逝者安息...",selectedPlayer:"1"}},computed:{characterDesc(){return x[this.selectedPlayer]}},mounted(){c.$on("notifyMessageAction",(({action:e,tag:t})=>{"confirm"===e&&t&&"restart"===t.source&&(this.isShow=!0)}))},beforeDestroy(){c.$off("notifyMessageAction")},methods:{togglePlayer(e){this.selectedPlayer=e},start(){u.character=f[this.selectedPlayer],this.isShow=!1,this.selectedPlayer="1",c.$emit("notifyStart")}}},k=(0,o.A)(b,(function(){var e=this,t=e._self._c;return t("section",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"pop-start"},[e._m(0),t("div",{staticClass:"primary-red"},[e._v("Web Edition")]),e._m(1),t("div",{staticClass:"desc style-font",attrs:{"data-content":e.desc}},[e._v(" "+e._s(e.desc)+" ")]),t("div",{staticClass:"select-player text-center"},[t("div",{staticClass:"box-player",class:["1"===e.selectedPlayer&&"active"],on:{click:function(t){return e.togglePlayer("1")}}},[t("img",{staticClass:"avatar",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/char_backpacker.jpg",alt:""}})]),t("div",{staticClass:"box-player",class:["2"===e.selectedPlayer&&"active"],on:{click:function(t){return e.togglePlayer("2")}}},[t("img",{staticClass:"avatar",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/char_sportgirl.jpg",alt:""}})]),t("div",{staticClass:"box-player",class:["3"===e.selectedPlayer&&"active"],on:{click:function(t){return e.togglePlayer("3")}}},[t("img",{staticClass:"avatar",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/char_oldman.jpg",alt:""}})]),t("div",{staticClass:"box-player",class:["4"===e.selectedPlayer&&"active"],on:{click:function(t){return e.togglePlayer("4")}}},[t("img",{staticClass:"avatar",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/char_soldier.jpg",alt:""}})])]),t("div",{staticClass:"char-desc"},[e._v(" "+e._s(e.characterDesc)+" ")]),t("div",{staticClass:"text-center",staticStyle:{"margin-top":"40px"}},[t("button",{staticClass:"primary-button start-button",on:{click:function(t){return e.start()}}},[e._v("开始")])])])}),[function(){var e=this._self._c;return e("div",{staticClass:"box-logo"},[e("img",{attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/game_logo.png",alt:""}})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"box-creator"},[t("div",{staticClass:"text-center"},[e._v("原桌游由Jeremiah Lee设计。为了更好的可玩性，Youngbeen基于原游戏设计做了一些调整，并实现了此程序版本")]),t("div",{staticClass:"text-center"},[e._v("All game program copyright reserved by Youngbeen 2024-present")])])}],!1,null,"f4d456fa",null).exports;const C=["9:00 PM","10:00 PM","11:00 PM","12:00 PM"];var I={data(){return{player:u,system:y}},computed:{nowClock(){return C[this.system.time]}}},_=(0,o.A)(I,(function(){var e=this,t=e._self._c;return t("section",{staticClass:"comp-top-panel"},[t("div",{staticClass:"box-hp"},[t("div",{staticClass:"label text-center"},[e._v("生命")]),t("div",{staticClass:"text text-center style-font"},[e._v(e._s(e.player.hp))])]),t("div",{staticClass:"box-time"},[t("div",{staticClass:"label text-center"},[e._v("时间")]),t("div",{staticClass:"text text-center style-font"},[e._v(e._s(e.nowClock)+"（"+e._s(e.system.events.length)+"）")])]),t("div",{staticClass:"box-totem-status"},[t("div",{staticClass:"label text-center"},[e._v("邪恶图腾")]),t("div",{staticClass:"text text-center style-font"},[e._v(e._s(e.player.gotTotem?"已找到":"未找到"))])])])}),[],!1,null,"15930bbf",null).exports;const T={backpacker:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/char_backpacker.jpg",sportgirl:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/char_sportgirl.jpg",oldman:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/char_oldman.jpg",soldier:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/char_soldier.jpg"};var R={props:{roomData:{type:Array,required:!0}},data(){return{player:u}},computed:{playerChar(){return this.player.character?T[this.player.character]:""}}},D=(0,o.A)(R,(function(){var e=this,t=e._self._c;return t("section",{staticClass:"comp-main-container"},[t("div",{staticClass:"layer-rooms"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.roomData[0].key,expression:"roomData[0].key"}],staticClass:"room room-0"},[t("img",{staticClass:"room-image",class:[e.roomData[0].rotate&&"rotate-"+e.roomData[0].rotate],attrs:{src:e.roomData[0].image,alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.roomData[1].key,expression:"roomData[1].key"}],staticClass:"room room-1"},[t("img",{staticClass:"room-image",class:[e.roomData[1].rotate&&"rotate-"+e.roomData[1].rotate],attrs:{src:e.roomData[1].image,alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.roomData[2].key,expression:"roomData[2].key"}],staticClass:"room room-2"},[t("img",{staticClass:"room-image",class:[e.roomData[2].rotate&&"rotate-"+e.roomData[2].rotate],attrs:{src:e.roomData[2].image,alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.roomData[3].key,expression:"roomData[3].key"}],staticClass:"room room-3"},[t("img",{staticClass:"room-image",class:[e.roomData[3].rotate&&"rotate-"+e.roomData[3].rotate],attrs:{src:e.roomData[3].image,alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.roomData[4].key,expression:"roomData[4].key"}],staticClass:"room center-room"},[t("img",{staticClass:"room-image",class:[e.roomData[4].rotate&&"rotate-"+e.roomData[4].rotate],attrs:{src:e.roomData[4].image,alt:""}}),t("img",{staticClass:"player",attrs:{src:e.playerChar,alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.roomData[5].key,expression:"roomData[5].key"}],staticClass:"room room-5"},[t("img",{staticClass:"room-image",class:[e.roomData[5].rotate&&"rotate-"+e.roomData[5].rotate],attrs:{src:e.roomData[5].image,alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.roomData[6].key,expression:"roomData[6].key"}],staticClass:"room room-6"},[t("img",{staticClass:"room-image",class:[e.roomData[6].rotate&&"rotate-"+e.roomData[6].rotate],attrs:{src:e.roomData[6].image,alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.roomData[7].key,expression:"roomData[7].key"}],staticClass:"room room-7"},[t("img",{staticClass:"room-image",class:[e.roomData[7].rotate&&"rotate-"+e.roomData[7].rotate],attrs:{src:e.roomData[7].image,alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.roomData[8].key,expression:"roomData[8].key"}],staticClass:"room room-8"},[t("img",{staticClass:"room-image",class:[e.roomData[8].rotate&&"rotate-"+e.roomData[8].rotate],attrs:{src:e.roomData[8].image,alt:""}})])])])}),[],!1,null,"8b011e32",null).exports;const S=()=>u.hp>0,$=()=>!!(u.buriedTotem&&u.hp>0),H=()=>{for(let e=u.items.length-1;e>=0;e--){const t=u.items[e];t.useTime<=0&&"chainsaw"!==t.key&&u.items.splice(e,1)}},A=()=>{let e=!1;for(let t=0;t<y.map.length;t++){const s=y.map[t],a=s.doors.map((e=>(e+s.rotate/90)%4));if(-1===y.map.findIndex((e=>e.x===s.x&&e.y===s.y-1))&&a.includes(0)){e=!0;break}if(-1===y.map.findIndex((e=>e.x===s.x&&e.y===s.y+1))&&a.includes(2)){e=!0;break}if(-1===y.map.findIndex((e=>e.x===s.x-1&&e.y===s.y))&&a.includes(3)){e=!0;break}if(-1===y.map.findIndex((e=>e.x===s.x+1&&e.y===s.y))&&a.includes(1)){e=!0;break}}return e};var z={props:{roomData:{type:Object,required:!0}},data(){return{isRotateNewRoomShow:!1,rotateDeg:0,newRoom:{image:""},isRunAwayShow:!1,runAwayRooms:{},newLocation:{},where:"",phase:""}},mounted(){c.$on("notifyMessageAction",(({action:e,tag:t,index:s})=>{t&&"getItem"===t.source?("confirm"===e?t.postEvent?this.phase="specialItem":this.phase="item":t.postEvent?(this.phase="",A()||this.dealBreakIn()):this.phase="specialEvent",this.dealRoomStory()):t&&"getSpecialItem"===t.source?"confirm"===e?(this.phase="specialItem",this.dealRoomStory()):(this.phase="",A()||this.dealBreakIn()):t&&"dropEventItem"===t.source?(s>=u.items.length||u.items.splice(s,1,t.newItem),this.phase="specialEvent",this.dealRoomStory()):t&&"dropSpecialItem"===t.source?(s>=u.items.length||u.items.splice(s,1,t.newItem),this.phase="",A()||this.dealBreakIn()):t&&"getTotem"===t.source?"confirm"===e?(this.phase="totem",this.dealRoomStory()):(this.phase="",A()||this.dealBreakIn()):t&&"finishGame"===t.source?(this.phase="finishGame",this.dealRoomStory()):t&&"restart"===t.source&&(this.isRotateNewRoomShow=!1,this.rotateDeg=0,this.newRoom={image:""},this.isRunAwayShow=!1,this.runAwayRooms={},this.newLocation={},this.where="",this.phase="")})),c.$on("notifyBattleResult",(({result:e,tag:t})=>{if("runAway"===e){const e=(()=>{let e=0;const t=y.map.find((e=>e.x===u.x&&e.y===u.y-1)),s=y.map.find((e=>e.x===u.x&&e.y===u.y+1)),a=y.map.find((e=>e.x===u.x-1&&e.y===u.y)),i=y.map.find((e=>e.x===u.x+1&&e.y===u.y));return t&&e++,s&&e++,a&&e++,i&&e++,{up:t,down:s,left:a,right:i,count:e}})();1===e.count?e.up?this.dealRunAway(0,-1):e.down?this.dealRunAway(0,1):e.left?this.dealRunAway(-1,0):e.right&&this.dealRunAway(1,0):(this.runAwayRooms=e,this.isRunAwayShow=!0)}else"win"===e&&(t&&"finishGame"===t.source?$()&&c.$emit("notifyMessage",{message:"你成功地结束了一切噩梦，游戏胜利🎉",confirmBtnText:"重新开始",tag:{source:"restart"}}):t&&"breakIn"===t.source?this.phase="":t&&t.postEvent?(this.phase="",A()||this.dealBreakIn()):(this.phase="specialEvent",this.dealRoomStory()))}))},beforeDestroy(){c.$off("notifyMessageAction"),c.$off("notifyBattleResult")},methods:{enter(e){const t=((e,t)=>{let s=0;switch(e.rotate){case 90:s=1;break;case 180:s=2;break;case 270:s=3;break;default:s=0}switch((t+s)%4){case 0:return{x:e.x,y:e.y-1};case 1:return{x:e.x+1,y:e.y};case 2:return{x:e.x,y:e.y+1};case 3:return{x:e.x-1,y:e.y}}})(this.roomData,e);if(y.map.find((e=>e.x===t.x&&e.y===t.y)))u.x=t.x,u.y=t.y,c.$emit("notifyRedraw"),this.phase="roomEvent",this.dealRoomStory();else if(this.roomData.outDoor&&this.roomData.outDoor.length&&this.roomData.outDoor.includes(e)){const e=[];let s=null;d.outdoors.forEach((t=>{"patio"===t.key?s={...t,where:"outdoor"}:e.push({...t,where:"outdoor"})})),y.outdoors=v(e),this.dealNewRoom(s,t)}else{let e=null;if("indoor"===this.roomData.where&&y.indoors.length)e=y.indoors.pop();else{if("outdoor"!==this.roomData.where||!y.outdoors.length)return void c.$emit("notifyMessage",{message:"这个方向似乎被堵死了..."});e=y.outdoors.pop()}e&&this.dealNewRoom(e,t)}},dealNewRoom(e,t){this.newRoom=e,this.rotateDeg=0,this.newLocation=t,this.where=this.roomData.where,this.isRotateNewRoomShow=!0,u.x=t.x,u.y=t.y,c.$emit("notifyRedraw")},rotate(){270===this.rotateDeg?this.rotateDeg=0:this.rotateDeg+=90},confirmRotate(){y.map.push({...this.newRoom,x:this.newLocation.x,y:this.newLocation.y,rotate:this.rotateDeg,where:this.newRoom.where||this.where}),this.isRotateNewRoomShow=!1,c.$emit("notifyRedraw"),this.phase="roomEvent",this.dealRoomStory()},dealRoomStory(){switch(this.phase){case"roomEvent":this.dealEvent();break;case"item":this.dealItem();break;case"specialEvent":this.dealSpecialEvent();break;case"specialItem":this.dealItem(!0);break;case"totem":this.dealFetchTotem();break;case"finishGame":this.dealFinishGame()}},dealEvent(e=!1){if(y.events.length||c.$emit("notifyShuffleEvents"),!y.events.length)return;const t=y.events.pop().timeEvents[y.time];switch(t.key){case"msg":c.$emit("notifyMessage",{message:t.desc}),e||(this.phase="specialEvent",this.dealRoomStory());break;case"getItem":c.$emit("notifyMessage",{message:"角落有件物品，要花点时间去看看吗？",confirmBtnText:"查看物品",cancelBtnText:"忽略",tag:{source:"getItem",postEvent:e}});break;case"battle":c.$emit("notifyHappenBattle",{count:t.zombies,tag:{postEvent:e}});break;case"effect":u.hp+=t.addHp,c.$emit("notifyMessage",{message:`${t.desc}（生命${t.addHp>=0?"+":""}${t.addHp}）`}),e||(this.phase="specialEvent",this.dealRoomStory())}},dealSpecialEvent(){const e=y.map.find((e=>e.x===u.x&&e.y===u.y));e.addHp>0?(u.hp+=e.addHp,c.$emit("notifyMessage",{message:`生命+${e.addHp}`})):"storage"===e.key?c.$emit("notifyMessage",{message:"角落有件物品，要花点时间去看看吗？",confirmBtnText:"查看物品",cancelBtnText:"忽略",tag:{source:"getSpecialItem"}}):"evilTemple"!==e.key||u.gotTotem?"graveyard"===e.key&&u.gotTotem?c.$emit("notifyMessage",{message:"将邪恶图腾填埋到这里！结束一切混乱",confirmBtnText:"填埋",tag:{source:"finishGame"}}):(this.phase="",A()||this.dealBreakIn()):c.$emit("notifyMessage",{message:"你感到隐隐传来的邪恶感觉，要现在搜索邪恶图腾吗？",confirmBtnText:"立刻搜索",cancelBtnText:"下次再说",tag:{source:"getTotem"}})},dealFinalEvent(){if(y.events.length||c.$emit("notifyShuffleEvents"),!y.events.length)return;const e=y.events.pop().timeEvents[y.time];switch(e.key){case"msg":c.$emit("notifyMessage",{message:e.desc}),$()&&c.$emit("notifyMessage",{message:"你成功地结束了一切噩梦，游戏胜利🎉",confirmBtnText:"重新开始",tag:{source:"restart"}});break;case"getItem":$()&&c.$emit("notifyMessage",{message:"你成功地结束了一切噩梦，游戏胜利🎉",confirmBtnText:"重新开始",tag:{source:"restart"}});break;case"battle":c.$emit("notifyHappenBattle",{count:e.zombies,disableRunAway:!0,tag:{source:"finishGame"}});break;case"effect":u.hp+=e.addHp,c.$emit("notifyMessage",{message:`${e.desc}（生命${e.addHp>=0?"+":""}${e.addHp}}）`}),$()&&c.$emit("notifyMessage",{message:"你成功地结束了一切噩梦，游戏胜利🎉",confirmBtnText:"重新开始",tag:{source:"restart"}})}},dealItem(e=!1){if(y.events.length||c.$emit("notifyShuffleEvents"),!y.events.length)return;const t=y.events.pop(),s=JSON.parse(JSON.stringify(p.items.find((e=>e.key===t.item))));u.items.length<u.maxItems?(u.items.push(s),c.$emit("notifyMessage",{message:"获得物品",icons:[s]}),e?(this.phase="",A()||this.dealBreakIn()):(this.phase="specialEvent",this.dealRoomStory())):this.dealDropItem(s,e)},dealDropItem(e,t=!1){c.$emit("notifyMessage",{message:"发现新物品！请选择要丢弃的物品",icons:[...u.items.map((e=>e)),e],selectable:!0,confirmBtnText:"丢弃",tag:{source:t?"dropSpecialItem":"dropEventItem",newItem:e}})},dealRunAway(e,t){this.isRunAwayShow=!1,this.runAwayRooms={},u.x+=e,u.y+=t,c.$emit("notifyRedraw"),c.$emit("notifyMessage",{message:"你成功从丧尸攻击中逃脱"}),this.phase="",A()||this.dealBreakIn()},dealBreakIn(){const e=(()=>{const e=y.map.find((e=>e.x===u.x&&e.y===u.y)),t=e.doors.map((t=>(t+e.rotate/90)%4));return-1!==y.map.findIndex((t=>t.x===e.x&&t.y===e.y-1))||t.includes(0)?-1!==y.map.findIndex((t=>t.x===e.x&&t.y===e.y+1))||t.includes(2)?-1!==y.map.findIndex((t=>t.x===e.x-1&&t.y===e.y))||t.includes(3)?-1!==y.map.findIndex((t=>t.x===e.x+1&&t.y===e.y))||t.includes(1)?-1:(5-e.rotate/90)%4:(7-e.rotate/90)%4:(6-e.rotate/90)%4:(4-e.rotate/90)%4})();if(e>-1){const t=y.map.findIndex((e=>e.x===u.x&&e.y===u.y)),s=JSON.parse(JSON.stringify(y.map[t]));s.doors.push(e),y.map.splice(t,1,s),c.$emit("notifyRedraw"),c.$emit("notifyHappenBattle",{count:l,disableRunAway:!0,tag:{source:"breakIn"}})}else c.$emit("notifyMessage",{message:"你已经无路可逃，游戏结束",confirmBtnText:"重新开始",tag:{source:"restart"}})},dealFetchTotem(){u.gotTotem=!0,this.dealEvent(!0)},dealFinishGame(){u.buriedTotem=!0,this.dealFinalEvent()}}},M=(0,o.A)(z,(function(){var e=this,t=e._self._c;return t("section",{staticClass:"comp-actions"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isRunAwayShow,expression:"!isRunAwayShow"}],staticClass:"layer-entrance",class:[e.roomData.rotate&&"rotate-"+e.roomData.rotate]},[e.roomData.doors&&e.roomData.doors.includes(0)?t("div",{staticClass:"top-enter",on:{click:function(t){return e.enter(0)}}},[t("svg",{staticClass:"icon-arrow",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"240",height:"240",fill:"currentColor"}},[t("path",{attrs:{d:"M13 12V20H11V12H4L12 4L20 12H13Z"}})])]):e._e(),e.roomData.doors&&e.roomData.doors.includes(1)?t("div",{staticClass:"right-enter",on:{click:function(t){return e.enter(1)}}},[t("svg",{staticClass:"icon-arrow",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"240",height:"240",fill:"currentColor"}},[t("path",{attrs:{d:"M12 13H4V11H12V4L20 12L12 20V13Z"}})])]):e._e(),e.roomData.doors&&e.roomData.doors.includes(2)?t("div",{staticClass:"bottom-enter",on:{click:function(t){return e.enter(2)}}},[t("svg",{staticClass:"icon-arrow",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"240",height:"240",fill:"currentColor"}},[t("path",{attrs:{d:"M13 12H20L12 20L4 12H11V4H13V12Z"}})])]):e._e(),e.roomData.doors&&e.roomData.doors.includes(3)?t("div",{staticClass:"left-enter",on:{click:function(t){return e.enter(3)}}},[t("svg",{staticClass:"icon-arrow",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"240",height:"240",fill:"currentColor"}},[t("path",{attrs:{d:"M12 13V20L4 12L12 4V11H20V13H12Z"}})])]):e._e()]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isRotateNewRoomShow,expression:"isRotateNewRoomShow"}],staticClass:"layer-rotate"},[t("img",{staticClass:"new-room",class:[e.rotateDeg&&"rotate-"+e.rotateDeg],attrs:{src:e.newRoom.image,alt:""}}),t("div",{staticClass:"icon-button icon-rotate",on:{click:function(t){return e.rotate()}}},[t("img",{staticClass:"icon",attrs:{src:s(9517),alt:""}})]),t("div",{staticClass:"icon-button icon-confirm",on:{click:function(t){return e.confirmRotate()}}},[t("img",{staticClass:"icon",attrs:{src:s(9232),alt:""}})])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isRunAwayShow,expression:"isRunAwayShow"}],staticClass:"layer-runaway"},[e.runAwayRooms.up?t("div",{staticClass:"top-enter",on:{click:function(t){return e.dealRunAway(0,-1)}}},[t("svg",{staticClass:"icon-arrow",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"240",height:"240",fill:"currentColor"}},[t("path",{attrs:{d:"M13 12V20H11V12H4L12 4L20 12H13Z"}})])]):e._e(),e.runAwayRooms.right?t("div",{staticClass:"right-enter",on:{click:function(t){return e.dealRunAway(1,0)}}},[t("svg",{staticClass:"icon-arrow",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"240",height:"240",fill:"currentColor"}},[t("path",{attrs:{d:"M12 13H4V11H12V4L20 12L12 20V13Z"}})])]):e._e(),e.runAwayRooms.down?t("div",{staticClass:"bottom-enter",on:{click:function(t){return e.dealRunAway(0,1)}}},[t("svg",{staticClass:"icon-arrow",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"240",height:"240",fill:"currentColor"}},[t("path",{attrs:{d:"M13 12H20L12 20L4 12H11V4H13V12Z"}})])]):e._e(),e.runAwayRooms.left?t("div",{staticClass:"left-enter",on:{click:function(t){return e.dealRunAway(-1,0)}}},[t("svg",{staticClass:"icon-arrow",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"240",height:"240",fill:"currentColor"}},[t("path",{attrs:{d:"M12 13V20L4 12L12 4V11H20V13H12Z"}})])]):e._e()])])}),[],!1,null,"efbd12d6",null).exports,B={data(){return{player:u}},mounted(){c.$on("notifyMessageAction",(({action:e,tag:t})=>{"confirm"===e&&t&&"cower"===t.source&&this.dealCower(t.cowerRecover)}))},beforeDestroy(){c.$off("notifyMessageAction")},methods:{handleUseItem(e){if(u.items.length&&e<u.items.length){const t=u.items[e];if("soda"===t.key)t.useTime>0&&(99!==t.useTime&&t.useTime--,u.hp+=t.addHp,c.$emit("notifyMessage",{message:`使用${t.name}，生命值+${t.addHp}`})),H();else if("gasoline"===t.key){const e=u.items.findIndex((e=>"chainsaw"===e.key));if(e>=0){const s=u.items[e];t.useTime>0&&(99!==t.useTime&&t.useTime--,99!==s.useTime&&(s.useTime+=2),c.$emit("notifyMessage",{message:"将汽油灌入链锯，链锯的使用次数增加了"})),H()}else c.$emit("notifyMessage",{message:t.desc})}else c.$emit("notifyMessage",{message:t.desc})}},handleCower(){let e=3;u.items.findIndex((e=>"bone"===e.key))>=0&&e--,c.$emit("notifyMessage",{message:`你要畏缩到一个隐秘的角落休整一段时间吗？（生命值+${e}，时间流逝1小时）`,confirmBtnText:"确定",cancelBtnText:"取消",tag:{source:"cower",cowerRecover:e}})},dealCower(e){u.hp+=e,c.$emit("notifyMessage",{message:`休整结束，生命值+${e}`}),y.time++,y.time>=m&&c.$emit("notifyMessage",{message:"午夜12点钟声敲响，游戏结束",confirmBtnText:"重新开始",tag:{source:"restart"}})},handleOpenMap(){c.$emit("notifyShowMap")}}},N=(0,o.A)(B,(function(){var e=this,t=e._self._c;return t("section",{staticClass:"comp-bottom-panel"},[t("div",{staticClass:"box-items"},e._l(e.player.maxItems,(function(s){return t("div",{key:s,staticClass:"box-item",on:{click:function(t){return e.handleUseItem(e.player.maxItems-s)}}},[e.player.items[e.player.maxItems-s]?t("img",{attrs:{src:e.player.items[e.player.maxItems-s].image,alt:""}}):e._e(),e.player.items[e.player.maxItems-s]&&e.player.items[e.player.maxItems-s].useTime?t("span",{staticClass:"left-time"},[e._v(e._s(99===e.player.items[e.player.maxItems-s].useTime?"∞":e.player.items[e.player.maxItems-s].useTime))]):e._e()])})),0),t("div",{staticClass:"icon-button",on:{click:function(t){return e.handleCower()}}},[t("img",{staticClass:"icon",attrs:{src:s(2076),alt:""}})]),t("div",{staticClass:"icon-button",on:{click:function(t){return e.handleOpenMap()}}},[t("img",{staticClass:"icon",attrs:{src:s(3442),alt:""}})])])}),[],!1,null,"9d502348",null).exports;let E=[];var j={data(){return{isShow:!1,confirmBtnText:"",cancelBtnText:"",content:"",icons:[],selectable:!1,selectIndex:-1,tag:""}},mounted(){c.$on("notifyMessage",(e=>{this.isShow?E.push(e):this.showMessage(e)}))},beforeDestroy(){c.$off("notifyMessage")},methods:{showMessage({message:e,confirmBtnText:t,cancelBtnText:s,icons:a,tag:i,selectable:o=!1}){this.content=e||"",this.icons=a||[],this.confirmBtnText=t||"",this.cancelBtnText=s||"",this.tag=i,this.selectable=o||!1,this.isShow=!0},handleSelect(e){this.selectable&&(this.selectIndex=e)},handleConfirm(){this.selectable&&-1===this.selectIndex||(c.$emit("notifyMessageAction",{action:"confirm",index:this.selectIndex,tag:this.tag}),this.tag&&"restart"===this.tag.source&&(E=[]),this.close())},handleCancel(){c.$emit("notifyMessageAction",{action:"cancel",index:this.selectIndex,tag:this.tag}),this.close()},close(){if(this.isShow=!1,this.confirmBtnText="",this.cancelBtnText="",this.content="",this.icons=[],this.selectable=!1,this.selectIndex=-1,this.tag="",E.length){const e=E.shift();this.showMessage(e)}}}},P=(0,o.A)(j,(function(){var e=this,t=e._self._c;return t("section",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"pop-message"},[t("div",{staticClass:"box-message"},[t("div",{staticClass:"text-center"},[e._v(e._s(e.content))]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.icons.length,expression:"icons.length"}],staticClass:"text-center",staticStyle:{"margin-top":"12px"}},e._l(e.icons,(function(s,a){return t("img",{key:a,staticClass:"message-icon",class:[e.selectIndex===a&&"active"],attrs:{src:s.image,alt:""},on:{click:function(t){return e.handleSelect(a)}}})})),0),t("div",{staticClass:"text-center",staticStyle:{"margin-top":"12px"}},[t("button",{staticClass:"primary-button",on:{click:function(t){return e.handleConfirm()}}},[e._v(e._s(e.confirmBtnText||"确定"))]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.cancelBtnText,expression:"cancelBtnText"}],staticClass:"default-button",staticStyle:{"margin-left":"12px"},on:{click:function(t){return e.handleCancel()}}},[e._v(e._s(e.cancelBtnText||"取消"))])])])])}),[],!1,null,"f7818bbc",null).exports,O={data(){return{isShow:!1,count:0,tabIndex:0,selectIndex:0,selectItem:"",disableRunAway:!1,tag:"",player:u,PlayerConfig:h,ItemConfig:p}},computed:{weapons(){return this.player.items.length?this.player.items.filter((e=>"weapon"===e.type&&e.useTime>0)):[]},activeWeapon(){return this.weapons.length&&this.selectIndex>=0?this.weapons[this.selectIndex]:{}},useItemDesc(){return this.selectItem?["candle+oil","candle+gasoline"].includes(this.selectItem)?"可以杀死所有房间的丧尸":"gasoline+chainsaw"===this.selectItem?"为链锯增加2次额外使用次数":p.items.find((e=>e.key===this.selectItem)).desc:""}},mounted(){c.$on("notifyHappenBattle",(e=>{this.happenBattle(e)})),c.$on("notifyMessageAction",(({action:e,tag:t})=>{"confirm"===e&&t&&"restart"===t.source&&this.close("restart")}))},beforeDestroy(){c.$off("notifyHappenBattle"),c.$off("notifyMessageAction")},methods:{happenBattle({count:e,disableRunAway:t,tag:s}){this.count=e||0,this.disableRunAway=t,this.tag=s,this.count&&(this.isShow=!0)},handleSelect(e){this.selectIndex=e},handleConfirm(){0===this.tabIndex?this.dealBattle():1===this.tabIndex&&this.selectItem&&"oil"!==this.selectItem?this.dealUseItem():2===this.tabIndex&&this.dealRunAway()},dealBattle(){let e=0;this.activeWeapon.key&&this.activeWeapon.useTime>0&&(e=this.activeWeapon.addAtk);const t=u.atk+e,s=this.count-t;s>=0&&(u.hp-=s,c.$emit("notifyMessage",{message:`战斗结束，生命值-${s}`}),!S())?c.$emit("notifyMessage",{message:"你没能幸免，游戏结束",confirmBtnText:"重新开始",tag:{source:"restart"}}):(99!==this.activeWeapon.useTime&&this.activeWeapon.useTime>0&&this.activeWeapon.useTime--,this.activeWeapon.useTime<=0&&H(),this.close())},dealUseItem(){switch(this.selectItem){case"grenade":{const e=u.items.findIndex((e=>e.key===this.selectItem));if(e>=0){const t=u.items[e];t.useTime>0&&(99!==t.useTime&&t.useTime--,c.$emit("notifyMessage",{message:"使用手雷炸死所有丧尸，战斗结束"}),H(),this.close())}break}case"candle+oil":{const e=u.items.findIndex((e=>"candle"===e.key)),t=u.items.findIndex((e=>"oil"===e.key));if(e>=0&&t>=0){const s=u.items[e],a=u.items[t];s.useTime>0&&a.useTime>0&&(99!==s.useTime&&s.useTime--,99!==a.useTime&&a.useTime--,c.$emit("notifyMessage",{message:"使用煤油和蜡烛点燃所有丧尸，战斗结束"}),H(),this.close())}break}case"candle+gasoline":{const e=u.items.findIndex((e=>"candle"===e.key)),t=u.items.findIndex((e=>"gasoline"===e.key));if(e>=0&&t>=0){const s=u.items[e],a=u.items[t];s.useTime>0&&a.useTime>0&&(99!==s.useTime&&s.useTime--,99!==a.useTime&&a.useTime--,c.$emit("notifyMessage",{message:"使用汽油和蜡烛点燃所有丧尸，战斗结束"}),H(),this.close())}break}case"gasoline+chainsaw":{const e=u.items.findIndex((e=>"gasoline"===e.key)),t=u.items.findIndex((e=>"chainsaw"===e.key));if(e>=0&&t>=0){const s=u.items[e],a=u.items[t];s.useTime>0&&(99!==s.useTime&&s.useTime--,99!==a.useTime&&(a.useTime+=2),c.$emit("notifyMessage",{message:"将汽油灌入链锯，链锯的使用次数增加了"}),H())}break}case"soda":{const e=u.items.findIndex((e=>e.key===this.selectItem));if(e>=0){const t=u.items[e];t.useTime>0&&(99!==t.useTime&&t.useTime--,u.hp+=t.addHp,c.$emit("notifyMessage",{message:`使用${t.name}，生命值+${t.addHp}`}),H())}break}}},dealRunAway(){const e=u.items.findIndex((e=>"oil"===e.key));if("oil"===this.selectItem&&e>=0){const t=u.items[e];t.useTime>0&&(99!==t.useTime&&t.useTime--,c.$emit("notifyMessage",{message:"你将煤油撒到地上，拖延了丧尸"}),H())}else if(u.hp-=h.runAwayDamage,!S())return void c.$emit("notifyMessage",{message:"你没能幸免，游戏结束",confirmBtnText:"重新开始",tag:{source:"restart"}});this.close("runAway")},close(e="win"){"restart"!==e&&c.$emit("notifyBattleResult",{result:e,tag:this.tag}),this.isShow=!1,this.count=0,this.tabIndex=0,this.selectIndex=0,this.selectItem="",this.disableRunAway=!1,this.tag=""}}},L=(0,o.A)(O,(function(){var e=this,t=e._self._c;return t("section",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"pop-happen-battle"},[t("div",{staticClass:"box-message"},[t("div",{staticClass:"text-center box-zombies"},e._l(e.count,(function(e){return t("img",{key:e,staticClass:"zombie-image",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/zombie.jpg",alt:""}})})),0),t("div",{staticClass:"text-center",staticStyle:{"margin-top":"12px"}},[e._v(" "+e._s(e.count)+"个丧尸围了过来！选择行动 ")]),t("div",{staticClass:"box-tabs"},[t("div",{staticClass:"tab",class:[0===e.tabIndex&&"active"],on:{click:function(t){e.tabIndex=0}}},[e._v("战斗")]),t("div",{staticClass:"tab",class:[1===e.tabIndex&&"active"],on:{click:function(t){e.tabIndex=1}}},[e._v("使用物品")]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.disableRunAway,expression:"!disableRunAway"}],staticClass:"tab",class:[2===e.tabIndex&&"active"],on:{click:function(t){e.tabIndex=2}}},[e._v("逃跑")])]),t("div",{staticClass:"box-action"},[t("div",{directives:[{name:"show",rawName:"v-show",value:0===e.tabIndex,expression:"tabIndex === 0"}]},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.weapons.length,expression:"weapons.length"}]},[e._v(" 选择要使用的武器： "),t("div",{staticClass:"text-center",staticStyle:{"margin-top":"6px"}},e._l(e.weapons,(function(s,a){return t("img",{key:a,staticClass:"item-icon",class:[e.selectIndex===a&&"active"],attrs:{src:s.image,alt:""},on:{click:function(t){return e.handleSelect(a)}}})})),0),t("div",{staticClass:"text-center"},[e._v(" 攻击"+e._s(e.player.atk)+"+"+e._s(e.activeWeapon.addAtk)+" 剩余次数"+e._s(99===e.activeWeapon.useTime?"无限":e.activeWeapon.useTime)+" ")])]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.weapons.length,expression:"!weapons.length"}],staticClass:"text-center"},[e._v(" 攻击"+e._s(e.player.atk)+" ")])]),t("div",{directives:[{name:"show",rawName:"v-show",value:1===e.tabIndex,expression:"tabIndex === 1"}]},[t("div",[e._v(" 选择要使用的物品： "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.player.items.map((e=>e.key)).includes("grenade"),expression:"player.items.map(i=> i.key).includes('grenade')"}],staticClass:"text-center box-item-choice",staticStyle:{"margin-top":"6px"},on:{click:function(t){e.selectItem="grenade"}}},[t("img",{directives:[{name:"show",rawName:"v-show",value:"grenade"!==e.selectItem,expression:"selectItem !== 'grenade'"}],staticClass:"item-radio",attrs:{src:s(5995),alt:""}}),t("img",{directives:[{name:"show",rawName:"v-show",value:"grenade"===e.selectItem,expression:"selectItem === 'grenade'"}],staticClass:"item-radio",attrs:{src:s(5626),alt:""}}),t("img",{staticClass:"item-icon",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/grenade.jpg",alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.player.items.map((e=>e.key)).includes("candle")&&e.player.items.map((e=>e.key)).includes("oil"),expression:"player.items.map(i=> i.key).includes('candle') && player.items.map(i=> i.key).includes('oil')"}],staticClass:"text-center box-item-choice",staticStyle:{"margin-top":"6px"},on:{click:function(t){e.selectItem="candle+oil"}}},[t("img",{directives:[{name:"show",rawName:"v-show",value:"candle+oil"!==e.selectItem,expression:"selectItem !== 'candle+oil'"}],staticClass:"item-radio",attrs:{src:s(5995),alt:""}}),t("img",{directives:[{name:"show",rawName:"v-show",value:"candle+oil"===e.selectItem,expression:"selectItem === 'candle+oil'"}],staticClass:"item-radio",attrs:{src:s(5626),alt:""}}),t("img",{staticClass:"item-icon",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/candle.jpg",alt:""}}),e._v(" + "),t("img",{staticClass:"item-icon",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/oil.jpg",alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.player.items.map((e=>e.key)).includes("candle")&&e.player.items.map((e=>e.key)).includes("gasoline"),expression:"player.items.map(i=> i.key).includes('candle') && player.items.map(i=> i.key).includes('gasoline')"}],staticClass:"text-center box-item-choice",staticStyle:{"margin-top":"6px"},on:{click:function(t){e.selectItem="candle+gasoline"}}},[t("img",{directives:[{name:"show",rawName:"v-show",value:"candle+gasoline"!==e.selectItem,expression:"selectItem !== 'candle+gasoline'"}],staticClass:"item-radio",attrs:{src:s(5995),alt:""}}),t("img",{directives:[{name:"show",rawName:"v-show",value:"candle+gasoline"===e.selectItem,expression:"selectItem === 'candle+gasoline'"}],staticClass:"item-radio",attrs:{src:s(5626),alt:""}}),t("img",{staticClass:"item-icon",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/candle.jpg",alt:""}}),e._v(" + "),t("img",{staticClass:"item-icon",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/gasoline.jpg",alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.player.items.map((e=>e.key)).includes("gasoline")&&e.player.items.map((e=>e.key)).includes("chainsaw"),expression:"player.items.map(i=> i.key).includes('gasoline') && player.items.map(i=> i.key).includes('chainsaw')"}],staticClass:"text-center box-item-choice",staticStyle:{"margin-top":"6px"},on:{click:function(t){e.selectItem="gasoline+chainsaw"}}},[t("img",{directives:[{name:"show",rawName:"v-show",value:"gasoline+chainsaw"!==e.selectItem,expression:"selectItem !== 'gasoline+chainsaw'"}],staticClass:"item-radio",attrs:{src:s(5995),alt:""}}),t("img",{directives:[{name:"show",rawName:"v-show",value:"gasoline+chainsaw"===e.selectItem,expression:"selectItem === 'gasoline+chainsaw'"}],staticClass:"item-radio",attrs:{src:s(5626),alt:""}}),t("img",{staticClass:"item-icon",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/gasoline.jpg",alt:""}}),e._v(" + "),t("img",{staticClass:"item-icon",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/chainsaw.jpg",alt:""}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.player.items.map((e=>e.key)).includes("soda"),expression:"player.items.map(i=> i.key).includes('soda')"}],staticClass:"text-center box-item-choice",staticStyle:{"margin-top":"6px"},on:{click:function(t){e.selectItem="soda"}}},[t("img",{directives:[{name:"show",rawName:"v-show",value:"soda"!==e.selectItem,expression:"selectItem !== 'soda'"}],staticClass:"item-radio",attrs:{src:s(5995),alt:""}}),t("img",{directives:[{name:"show",rawName:"v-show",value:"soda"===e.selectItem,expression:"selectItem === 'soda'"}],staticClass:"item-radio",attrs:{src:s(5626),alt:""}}),t("img",{staticClass:"item-icon",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/soda.jpg",alt:""}})]),t("div",{staticClass:"text-center"},[e._v(" "+e._s(e.useItemDesc)+" ")])])]),t("div",{directives:[{name:"show",rawName:"v-show",value:2===e.tabIndex,expression:"tabIndex === 2"}]},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.player.items.map((e=>e.key)).includes("oil"),expression:"player.items.map(i=> i.key).includes('oil')"}]},[e._v(" 选择使用的物品： "),t("div",{staticClass:"text-center box-item-choice",staticStyle:{"margin-top":"6px"},on:{click:function(t){"oil"===e.selectItem?e.selectItem="":e.selectItem="oil"}}},[t("img",{directives:[{name:"show",rawName:"v-show",value:"oil"!==e.selectItem,expression:"selectItem !== 'oil'"}],staticClass:"item-radio",attrs:{src:s(5995),alt:""}}),t("img",{directives:[{name:"show",rawName:"v-show",value:"oil"===e.selectItem,expression:"selectItem === 'oil'"}],staticClass:"item-radio",attrs:{src:s(5626),alt:""}}),t("img",{staticClass:"item-icon",attrs:{src:"https://gitee.com/youngbeen/zombies-in-my-pocket/raw/master/src/assets/oil.jpg",alt:""}})]),t("div",{staticClass:"text-center"},[e._v(" "+e._s(e.ItemConfig.items.find((e=>"oil"===e.key)).desc)+" ")])]),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.player.items.map((e=>e.key)).includes("oil"),expression:"!player.items.map(i=> i.key).includes('oil')"}],staticClass:"text-center"},[e._v(" 逃跑时受到"+e._s(e.PlayerConfig.runAwayDamage)+"伤害 ")])])]),t("div",{staticClass:"text-center",staticStyle:{"margin-top":"12px"}},[t("button",{staticClass:"primary-button",on:{click:function(t){return e.handleConfirm()}}},[e._v("确定")])])])])}),[],!1,null,"f628a21e",null).exports;const V=360,W=20,Z=10;var F={data(){return{isShow:!1,width:V,height:V,ratio:1.5,canvas:null,ctx:null}},mounted(){this.canvas=document.querySelector("#map-canvas"),this.ctx=this.canvas.getContext("2d"),c.$on("notifyShowMap",(()=>{this.showMap()}))},beforeDestroy(){c.$off("notifyShowMap")},methods:{showMap(){this.isShow=!0,this.drawMap()},drawMap(){const e=[...y.map],t=[...new Set(e.map((e=>e.x)))],s=[...new Set(e.map((e=>e.y)))],a=Math.min(...t),i=Math.max(...t),o=Math.min(...s),n=Math.max(...s)-o+1,r={width:25*(i-a+1)*this.ratio,height:25*n*this.ratio};let c=0,m=0;r.width>V?(this.width=r.width,c=0):c=(V-r.width)/2,r.height>V?(this.height=r.height,m=0):m=(V-r.height)/2,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),e.forEach((e=>{this.ctx.fillStyle="red",this.ctx.fillRect(c+25*(e.x-a)*this.ratio,m+25*(e.y-o)*this.ratio,W*this.ratio,W*this.ratio),this.ctx.fillStyle="white",e.doors.forEach((t=>{switch((t+e.rotate/90)%4){case 0:this.ctx.fillRect(c+25*(e.x-a)*this.ratio+5*this.ratio,m+25*(e.y-o)*this.ratio,Z*this.ratio,3);break;case 1:this.ctx.fillRect(c+25*(e.x-a)*this.ratio+W*this.ratio-3,m+25*(e.y-o)*this.ratio+5*this.ratio,3,Z*this.ratio);break;case 2:this.ctx.fillRect(c+25*(e.x-a)*this.ratio+5*this.ratio,m+25*(e.y-o)*this.ratio+W*this.ratio-3,Z*this.ratio,3);break;case 3:this.ctx.fillRect(c+25*(e.x-a)*this.ratio,m+25*(e.y-o)*this.ratio+5*this.ratio,3,Z*this.ratio)}})),u.x===e.x&&u.y===e.y?(this.ctx.fillStyle="gold",this.ctx.beginPath(),this.ctx.arc(c+25*(e.x-a)*this.ratio+10*this.ratio,m+25*(e.y-o)*this.ratio+10*this.ratio,5*this.ratio,0,2*Math.PI),this.ctx.fill(),this.ctx.closePath()):["foyer","kitchen","storage","evilTemple","garden","graveyard"].includes(e.key)&&(this.ctx.fillStyle="white",this.ctx.font=8*this.ratio+"px serif",this.ctx.fillText(e.name[0],c+25*(e.x-a)*this.ratio+5*this.ratio,m+25*(e.y-o)*this.ratio+5*this.ratio+8*this.ratio,10*this.ratio))}))},handleZoom(e){this.ratio+e<=3&&this.ratio+e>=1.5&&(this.ratio+=e,this.drawMap())},handleClose(){this.isShow=!1,this.width=V,this.height=V}}},G={components:{StartPop:k,TopPanel:_,MainContainer:D,ActionContainer:M,BottomPanel:N,MessagePop:P,HappenBattlePop:L,MapPop:(0,o.A)(F,(function(){var e=this,t=e._self._c;return t("section",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"pop-map"},[t("div",{staticClass:"box-map"},[t("canvas",{attrs:{id:"map-canvas",width:e.width,height:e.height}})]),t("div",{staticClass:"box-actions"},[t("div",{staticClass:"icon-button",on:{click:function(t){return e.handleZoom(.25)}}},[t("img",{staticClass:"icon",attrs:{src:s(4801),alt:""}})]),t("div",{staticClass:"icon-button",on:{click:function(t){return e.handleZoom(-.25)}}},[t("img",{staticClass:"icon",attrs:{src:s(6672),alt:""}})]),t("div",{staticClass:"icon-button",on:{click:function(t){return e.handleClose()}}},[t("img",{staticClass:"icon",attrs:{src:s(5124),alt:""}})])])])}),[],!1,null,"9edfb2e0",null).exports},data(){return{displayedRooms:[{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0}]}},mounted(){c.$on("notifyStart",(()=>{this.start()})),c.$on("notifyRedraw",(()=>{this.draw()})),c.$on("notifyShuffleEvents",(()=>{this.shuffleEvents()}))},beforeDestroy(){c.$off("notifyStart"),c.$off("notifyRedraw"),c.$off("notifyShuffleEvents")},methods:{start(){this.initData(),this.draw()},initData(){y.time=0,y.events=[],y.indoors=[],y.outdoors=[],y.map=[],u.hp=h.baseHp,u.atk=h.baseAtk,u.x=0,u.y=0,u.gotTotem=!1,u.buriedTotem=!1,u.items=[],"backpacker"===u.character?(u.maxItems=h.maxItems+h.backpackerExtraItems,u.items.push(p.items.find((e=>"candle"===e.key)))):u.maxItems=h.maxItems,"sportgirl"===u.character?u.items.push(p.items.find((e=>"soda"===e.key))):"oldman"===u.character?u.items.push(p.items.find((e=>"gasoline"===e.key))):"soldier"===u.character&&u.items.push(p.items.find((e=>"grenade"===e.key))),this.initRooms(),this.shuffleEvents(!0)},initRooms(){const e=[];d.indoors.forEach((t=>{"foyer"===t.key?y.map.push({...t,rotate:0,x:0,y:0,where:"indoor"}):e.push({...t,where:"indoor"})})),y.indoors=v(e)},shuffleEvents(e=!1){if(!e&&(y.time++,y.time>=m))return void c.$emit("notifyMessage",{message:"午夜12点钟声敲响，游戏结束",confirmBtnText:"重新开始",tag:{source:"restart"}});const t=g.events.map((e=>e));y.events=v(t),y.events.pop(),"sportgirl"!==u.character&&y.events.pop()},draw(){this.drawRooms()},drawRooms(){this.displayedRooms=[{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0},{image:"",rotate:0}],y.map.forEach((e=>{e.x===u.x-1&&e.y===u.y-1?this.$set(this.displayedRooms,0,{...e}):e.x===u.x&&e.y===u.y-1?this.$set(this.displayedRooms,1,{...e}):e.x===u.x+1&&e.y===u.y-1?this.$set(this.displayedRooms,2,{...e}):e.x===u.x-1&&e.y===u.y?this.$set(this.displayedRooms,3,{...e}):e.x===u.x&&e.y===u.y?this.$set(this.displayedRooms,4,{...e}):e.x===u.x+1&&e.y===u.y?this.$set(this.displayedRooms,5,{...e}):e.x===u.x-1&&e.y===u.y+1?this.$set(this.displayedRooms,6,{...e}):e.x===u.x&&e.y===u.y+1?this.$set(this.displayedRooms,7,{...e}):e.x===u.x+1&&e.y===u.y+1&&this.$set(this.displayedRooms,8,{...e})}))}}},J=(0,o.A)(G,(function(){var e=this,t=e._self._c;return t("section",{staticClass:"page-home"},[t("start-pop"),t("top-panel"),t("main-container",{attrs:{"room-data":e.displayedRooms}}),t("action-container",{attrs:{"room-data":e.displayedRooms[4]}}),t("bottom-panel"),t("message-pop"),t("happen-battle-pop"),t("map-pop")],1)}),[],!1,null,"41b5c19a",null).exports;a.Ay.use(r.Ay);var U=new r.Ay({routes:[{path:"/",redirect:"/home"},{path:"/home",name:"home",component:J}]});s(1518),a.Ay.config.productionTip=!1,new a.Ay({router:U,render:e=>e(n)}).$mount("#app")},5995:function(e,t,s){e.exports=s.p+"img/icon_checkbox_blank_circle.9fee3b5e.svg"},5626:function(e,t,s){e.exports=s.p+"img/icon_checkbox_circle_fill.5390b2a7.svg"},5124:function(e,t,s){e.exports=s.p+"img/icon_close.75354a39.svg"},9232:function(e,t,s){e.exports=s.p+"img/icon_confirm.bbf61c14.svg"},2076:function(e,t,s){e.exports=s.p+"img/icon_heart.870a4e85.svg"},3442:function(e,t,s){e.exports=s.p+"img/icon_map.dae6e24e.svg"},9517:function(e,t,s){e.exports=s.p+"img/icon_rotate.3c2e1960.svg"},4801:function(e,t,s){e.exports=s.p+"img/icon_zoom_in.7b514cf2.svg"},6672:function(e,t,s){e.exports=s.p+"img/icon_zoom_out.c1d4d3c8.svg"}},s={};function a(e){var i=s[e];if(void 0!==i)return i.exports;var o=s[e]={exports:{}};return t[e].call(o.exports,o,o.exports,a),o.exports}a.m=t,e=[],a.O=function(t,s,i,o){if(!s){var n=1/0;for(l=0;l<e.length;l++){s=e[l][0],i=e[l][1],o=e[l][2];for(var r=!0,c=0;c<s.length;c++)(!1&o||n>=o)&&Object.keys(a.O).every((function(e){return a.O[e](s[c])}))?s.splice(c--,1):(r=!1,o<n&&(n=o));if(r){e.splice(l--,1);var m=i();void 0!==m&&(t=m)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[s,i,o]},a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="/zimp/",function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,o,n=s[0],r=s[1],c=s[2],m=0;if(n.some((function(t){return 0!==e[t]}))){for(i in r)a.o(r,i)&&(a.m[i]=r[i]);if(c)var l=c(a)}for(t&&t(s);m<n.length;m++)o=n[m],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(l)},s=self.webpackChunkzimp_h5=self.webpackChunkzimp_h5||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var i=a.O(void 0,[504],(function(){return a(1587)}));i=a.O(i)}();
//# sourceMappingURL=app.5856dbb1.js.map